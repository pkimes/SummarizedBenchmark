<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Feature: Error Handling • SummarizedBenchmark</title>
<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min.js" integrity="sha256-hIvIxeqhGZF+VVeM55k0mJvWpQ6gTkWk3Emc+NmowYA=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Feature: Error Handling">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SummarizedBenchmark</a>
        <span class="label label-info" data-toggle="tooltip" data-placement="bottom" title="Bioc Devel">1.99.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/SummarizedBenchmark-Introduction.html">Quick Start</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">General</li>
    <li>
      <a href="../articles/SummarizedBenchmark-Introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/SummarizedBenchmark-ClassDetails.html">Class Details</a>
    </li>
    <li>
      <a href="../articles/SummarizedBenchmark-FullCaseStudy.html">Full Case Study</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Features</li>
    <li>
      <a href="../articles/Feature-ErrorHandling.html">Error Handling</a>
    </li>
    <li>
      <a href="../articles/Feature-Iterative.html">Iterative Benchmarking</a>
    </li>
    <li>
      <a href="../articles/Feature-Parallel.html">Parallelization</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">More Case Studies</li>
    <li>
      <a href="../articles/CaseStudy-SingleCellSimulation.html">scRNA-seq Simulation</a>
    </li>
    <li>
      <a href="../articles/CaseStudy-RNAseqQuantification.html">RNA-seq Quantification</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/areyesq89/SummarizedBenchmark">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Feature: Error Handling</h1>
                        <h4 class="author">Patrick K. Kimes, Alejandro Reyes</h4>
            
            <h4 class="date">5 November 2018</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/areyesq89/SummarizedBenchmark/blob/master/vignettes/Feature-ErrorHandling.Rmd"><code>vignettes/Feature-ErrorHandling.Rmd</code></a></small>
      <div class="hidden name"><code>Feature-ErrorHandling.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      “Method execution in the <code>SummarizedBenchmark</code> framework is handled by the <code><a href="../reference/buildBench.html">buildBench()</a></code> function. Occassionally, errors occur when running several methods on a new data set. The approach to error handling implemented in the <code><a href="../reference/buildBench.html">buildBench()</a></code> function is described in this vignette along with options to disable error handling. SummarizedBenchmark package version: 1.99.3”
    </div>
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>When running a large benchmark study, not uncommonly, a single or a small subset of methods may fail during execution. This may be the result of misspecified parameters, an underlying bug in the software, or any number of other reasons. By default, errors thrown by methods which fail during <code><a href="../reference/buildBench.html">buildBench()</a></code> or <code><a href="../reference/updateBench.html">updateBench()</a></code> (see <strong>Feature: Iterative Benchmarking</strong> for details on <code><a href="../reference/updateBench.html">updateBench()</a></code>) are caught and handled in a user-friendly way. As long as a single method executes without any errors, a <em>SummarizedBenchmark</em> object is returned as usual, with the assay columns of failed methods set to <code>NA</code>. Additionally, the corresponding error messages are stored in the metadata of the object for reference.</p>
</div>
<div id="simple-case-study" class="section level1">
<h1 class="hasAnchor">
<a href="#simple-case-study" class="anchor"></a>Simple Case Study</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(SummarizedBenchmark)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(magrittr)</a></code></pre></div>
<p>As an example, consider the following example where we run case where we benchmark two simple methods. The first, <code>slowMethod</code> draws 5 random normal samples after waiting 5 seconds, and the second, <code>fastMethod</code> draws 5 random normal samples immediately. Each method is then passed through two post-processing functions, <code>keepSlow</code> and <code>makeSlower</code>, and <code>keepFast</code> and <code>makeSlower</code>, respectively. This results in three partially overlapping assays, <code>keepSlow</code>, <code>keepFast</code> and <code>makeSlower</code>. With this example, we also demonstrate how mismatched assays are handled across methods.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">bdslow &lt;-<span class="st"> </span><span class="kw"><a href="../reference/BenchDesign.html">BenchDesign</a></span>(<span class="dt">data =</span> tdat) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="../reference/addMethod.html">addMethod</a></span>(<span class="st">"slowMethod"</span>, <span class="cf">function</span>() { <span class="kw">Sys.sleep</span>(<span class="dv">5</span>); <span class="kw">rnorm</span>(<span class="dv">5</span>) },</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">              <span class="dt">post =</span> <span class="kw">list</span>(<span class="dt">keepSlow =</span> identity,</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">                          <span class="dt">makeSlower =</span> <span class="cf">function</span>(x) { <span class="kw">Sys.sleep</span>(<span class="dv">5</span>); x })) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="st">    </span><span class="kw"><a href="../reference/addMethod.html">addMethod</a></span>(<span class="st">"fastMethod"</span>, <span class="cf">function</span>() { <span class="kw">rnorm</span>(<span class="dv">5</span>) },</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">              <span class="dt">post =</span> <span class="kw">list</span>(<span class="dt">keepFast =</span> identity,</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">                          <span class="dt">makeSlower =</span> <span class="cf">function</span>(x) { <span class="kw">Sys.sleep</span>(<span class="dv">5</span>); x }))</a></code></pre></div>
<p>We run these methods in parallel using <code>parallel = TRUE</code> and specify a timeout limit of 1 second for the <code>BPPARAM</code>. Naturally, <code>slowMethod</code> will fail, and <code>fastMethod</code> will fail during the <code>makeSlower</code> post-processing function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">bpp &lt;-<span class="st"> </span><span class="kw">SerialParam</span>()</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">bptimeout</span>(bpp) &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">sbep &lt;-<span class="st"> </span><span class="kw"><a href="../reference/buildBench.html">buildBench</a></span>(bdslow, <span class="dt">parallel =</span> <span class="ot">TRUE</span>, <span class="dt">BPPARAM =</span> bpp)</a></code></pre></div>
<pre><code>## !! error caught in buildBench !!
## !! error in main function of method: 'slowMethod'</code></pre>
<pre><code>## !!  original message: 
## !!  reached elapsed time limit</code></pre>
<pre><code>## !! error caught in buildBench !!
## !! error in method: 'fastMethod', post: 'makeSlower'</code></pre>
<pre><code>## !!  original message: 
## !!  reached elapsed time limit</code></pre>
<p>Notice that during the execution process, errors caught by <code><a href="../reference/buildBench.html">buildBench()</a></code> are printed to the console along with the name of the failed method and post-processing function when appropriate.</p>
<p>We can verify that a valid <em>SummarizedBenchmark</em> object is still returned with the the remaining results.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">sbep</a></code></pre></div>
<pre><code>## class: SummarizedBenchmark 
## dim: 5 2 
## metadata(1): sessions
## assays(3): keepFast keepSlow makeSlower
## rownames: NULL
## rowData names(3): keepFast keepSlow makeSlower
## colnames(2): slowMethod fastMethod
## colData names(4): func.pkg func.pkg.vers func.pkg.manual
##   session.idx</code></pre>
<p>We can also check the values of the assays.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">sapply</span>(<span class="kw">assayNames</span>(sbep), assay, <span class="dt">x =</span> sbep, <span class="dt">simplify =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## $keepFast
##      slowMethod  fastMethod
## [1,]         NA  0.03554083
## [2,]         NA  0.46968793
## [3,]         NA -0.86463699
## [4,]         NA -0.56756989
## [5,]         NA -0.76146404
## 
## $keepSlow
##      slowMethod fastMethod
## [1,]         NA         NA
## [2,]         NA         NA
## [3,]         NA         NA
## [4,]         NA         NA
## [5,]         NA         NA
## 
## $makeSlower
##      slowMethod fastMethod
## [1,]         NA         NA
## [2,]         NA         NA
## [3,]         NA         NA
## [4,]         NA         NA
## [5,]         NA         NA</code></pre>
<p>Notice that most columns contain only <code>NA</code> values. These columns correspond to both methods which returned errors, as well as methods missing post-processing functions, e.g. no <code>keepSlow</code> function was defined for the <code>fastMethod</code> method. While the <code>NA</code> values cannot be used to distinguish the sources of the <code>NA</code> values, this is documented in the <code>sessions</code> list of the <em>SummarizedBenchmark</em> metadata. While the <code>sessions</code> object is a list containing information for all previous sessions, we are only interested in the current, first session. (For more details on why multiple sessions may be run, see the <strong>Feature: Iterative Benchmarking</strong> vignette.)</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">names</span>(<span class="kw">metadata</span>(sbep)<span class="op">$</span>sessions[[<span class="dv">1</span>]])</a></code></pre></div>
<pre><code>## [1] "methods"     "results"     "parameters"  "sessionInfo"</code></pre>
<p>In <code>sessions</code>, there is a <code>"results"</code> entry which includes a summary of the results for each combination of method and post-processing function (assay). The entries of <code>results</code> can take one of three values: <code>"success"</code>, <code>"missing"</code>, or an error message of class <code>buildbench-error</code>. The easiest way to view these resultsis by passing the <code>results</code> to the base R function, <code>simplify2array()</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">sess1res &lt;-<span class="st"> </span><span class="kw">metadata</span>(sbep)<span class="op">$</span>sessions[[<span class="dv">1</span>]]<span class="op">$</span>results</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw">simplify2array</span>(sess1res)</a></code></pre></div>
<pre><code>##            slowMethod                   fastMethod                  
## keepSlow   "reached elapsed time limit" "reached elapsed time limit"
## makeSlower "reached elapsed time limit" "missing"                   
## keepFast   "missing"                    "success"</code></pre>
<p>In the returned table, columns correspond to methods, and rows correspond to assays. We clearly see that many of the methods failed due to exceeding the specified time limit. If we check one of these entries more closesly, we see that it is indeed a <code>buildbench-error</code> object that occurred (<code>"origin"</code>) during the <code>"main"</code> function.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">sess1res<span class="op">$</span>slowMethod<span class="op">$</span>keepSlow</a></code></pre></div>
<pre><code>## [1] "reached elapsed time limit"
## attr(,"class")
## [1] "buildbench-error"
## attr(,"origin")
## [1] "main"</code></pre>
</div>
<div id="disable-handling" class="section level1">
<h1 class="hasAnchor">
<a href="#disable-handling" class="anchor"></a>Disable Handling</h1>
<p>If this error handling is not wanted, and the user would like the benchmark experiment to terminate when an error is thrown, then optional parameter <code>catchErrors = FALSE</code> can be specified to eiher <code><a href="../reference/buildBench.html">buildBench()</a></code> or <code><a href="../reference/updateBench.html">updateBench()</a></code>. Generally, this is advised against as the outputs computed for all non-failing methods will also be lost. As a result, the entire benchmarking experiment will need to be re-executed.</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#simple-case-study">Simple Case Study</a></li>
      <li><a href="#disable-handling">Disable Handling</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://alejandroreyes.org">Alejandro Reyes</a>, <a href="https://www.pkimes.com">Patrick Kimes</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
